DLABEL(string0) TIGER_STRING("hello, ")
DLABEL(string1) TIGER_STRING("world")

#include <Tiger-stdlib-stack-data.hera>

CBON()
    INC(SP, 3)
    SET(R1, 666)
    STORE(R1, 0, FP)
    SET(R1, 42)
    STORE(R1, 1, FP)
    MOVE(R12, SP)
    INC(SP, 4)
    STORE(FP, 2, R12)
    CALL(R12, f0)
    LOAD(R1, 3, R12)
    DEC(SP, 4)
HALT()

#include <Tiger-stdlib-stack.hera>
LABEL(array_out_of_bounds0)
    print("attempted illegal array access... halting")
    HALT()
LABEL(nil_record0)
    print("attempted use of a nil record... halting")
    HALT()

LABEL(f0)
    INC(SP, 1)
    STORE(R13, 0, FP)
    STORE(R12, 1, FP)
    STORE(R1, 4, FP)
    MOVE(R12, SP)
    INC(SP, 4)
    STORE(FP, 2, R12)
    CALL(R12, g0)
    LOAD(R1, 3, R12)
    DEC(SP, 4)
    STORE(R1, 3, FP)
    LOAD(R1, 4, FP)
    LOAD(R13, 0, FP)
    LOAD(R12, 1, FP)
    DEC(SP, 1)
    RETURN(R12, R13)
LABEL(g0)
    INC(SP, 5)
    STORE(R13, 0, FP)
    STORE(R12, 1, FP)
    STORE(R1, 4, FP)
    MOVE(R12, SP)
    INC(SP, 4)
    STORE(FP, 2, R12)
    CALL(R12, finally0)
    LOAD(R1, 3, R12)
    DEC(SP, 4)
    SET(R1, string0)
    STORE(R1, 6, FP)
    SET(R1, string1)
    STORE(R1, 7, FP)
    MOVE(R12, SP)
    INC(SP, 5)
    LOAD(R1, 6, FP)
    STORE(R1, 3, R12)
    LOAD(R1, 7, FP)
    STORE(R1, 4, R12)
    STORE(FP, 2, R12)
    CALL(R12, concat)
    LOAD(R1, 3, R12)
    DEC(SP, 5)
    STORE(R1, 5, FP)
    STORE(R1, 3, FP)
    LOAD(R1, 4, FP)
    LOAD(R13, 0, FP)
    LOAD(R12, 1, FP)
    DEC(SP, 5)
    RETURN(R12, R13)
LABEL(finally0)
    INC(SP, 2)
    STORE(R13, 0, FP)
    STORE(R12, 1, FP)
    STORE(R1, 4, FP)
    LOAD(R1, 2, FP)
    LOAD(R1, 2, R1)
    LOAD(R1, 2, R1)
    LOAD(R1, 1, R1)
    STORE(R1, 5, FP)
    MOVE(R12, SP)
    INC(SP, 4)
    LOAD(R1, 5, FP)
    STORE(R1, 3, R12)
    STORE(FP, 2, R12)
    CALL(R12, printint)
    LOAD(R1, 3, R12)
    DEC(SP, 4)
    STORE(R1, 3, FP)
    LOAD(R1, 4, FP)
    LOAD(R13, 0, FP)
    LOAD(R12, 1, FP)
    DEC(SP, 2)
    RETURN(R12, R13)
